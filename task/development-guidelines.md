# 개발 지침 (Development Guidelines)

## 🎯 **개발 원칙**

### **Clean Architecture 원칙**
- 도메인 중심의 계층화된 아키텍처 유지
- 의존성 역전 원칙 준수
- 인터페이스와 구현체 분리

### **TDD (Test-Driven Development)**
- 테스트 코드를 먼저 작성
- 리팩토링을 통한 코드 품질 향상
- 지속적인 테스트 실행

## 🚨 **중요: 파일 경로 관리 지침**

### **절대 경로 사용 원칙**
- **모든 파일 생성 시 절대 경로 사용 필수**
- **상대 경로 사용 금지** (경로 오류 발생 원인)
- **올바른 경로 형식**: `services/was-server/app/...`

### **작업 디렉토리 확인 절차**
파일/디렉토리 생성 명령어 실행 전 **반드시** 다음 절차 수행:

1. **현재 위치 확인**
   ```bash
   pwd
   ```

2. **작업 디렉토리 확인**
   ```bash
   ls -la
   ```

3. **필요시 올바른 디렉토리로 이동**
   ```bash
   cd services/was-server
   ```

4. **경로 확인 후 명령어 실행**
   ```bash
   mkdir -p app/api/v1
   ```

### **파일 생성 시 경로 검증**
- `edit_file` 도구 사용 시 **절대 경로** 명시
- 파일 생성 후 `find` 명령으로 실제 위치 확인
- 잘못된 위치 발견 시 즉시 정리

### **잘못된 경로 문제 해결 방안**
1. **즉시 정리**: 잘못 생성된 파일들 삭제
2. **절대 경로 재생성**: 올바른 위치에 파일 재생성
3. **경로 검증**: 생성된 파일 위치 재확인

## 🔧 **개발 환경 설정**

### **Docker 환경**
- Docker Compose를 통한 일관된 개발 환경
- 볼륨 마운트를 통한 파일 동기화
- 컨테이너 재시작 시 파일 변경사항 반영

### **데이터베이스 연결**
- PostgreSQL 연결 시 비밀번호 특수문자 처리
- SSH 터널을 통한 안전한 데이터베이스 접근
- 환경 변수를 통한 설정 관리

## 📁 **프로젝트 구조 관리**

### **디렉토리 구조**
```
services/was-server/
├── app/                    # 메인 애플리케이션
│   ├── api/               # API 레이어
│   ├── core/              # 핵심 설정
│   ├── domain/            # 도메인 레이어
│   ├── infrastructure/    # 인프라스트럭처 레이어
│   └── interfaces/        # 인터페이스 레이어
├── tests/                 # 테스트 코드
└── alembic/               # 데이터베이스 마이그레이션
```

### **파일 명명 규칙**
- Python 파일: `snake_case.py`
- 클래스: `PascalCase`
- 함수/변수: `snake_case`
- 상수: `UPPER_SNAKE_CASE`

## 🧪 **테스트 지침**

### **테스트 작성 원칙**
- 각 도메인 엔티티별 단위 테스트
- 리포지토리 패턴 테스트
- 의존성 주입 시스템 테스트
- 통합 테스트를 통한 전체 시스템 검증

### **테스트 실행**
```bash
# 전체 테스트 실행
pytest

# 특정 테스트 파일 실행
pytest tests/core/test_container.py

# 상세 출력과 함께 실행
pytest -v
```

## 📝 **코드 품질**

### **코드 스타일**
- Black을 통한 코드 포맷팅
- Flake8을 통한 린팅
- MyPy를 통한 타입 체크

### **문서화**
- 모든 함수와 클래스에 docstring 작성
- 복잡한 로직에 주석 추가
- README 파일 최신 상태 유지

## 🚀 **배포 및 운영**

### **환경별 설정**
- `env.local`: 로컬 개발 환경
- `env.dev`: 개발 서버 환경
- `env.prod`: 운영 서버 환경

### **Docker 배포**
- 개발용: `docker-compose.dev.yml`
- 운영용: `docker-compose.prod.yml`
- 환경별 설정 파일 분리

## 🔍 **문제 해결 가이드**

### **자주 발생하는 문제**
1. **파일 경로 오류**: 절대 경로 사용으로 해결
2. **Docker 파일 동기화**: 볼륨 마운트 설정 확인
3. **데이터베이스 연결**: SSH 터널 및 환경 변수 확인
4. **모듈 임포트 오류**: Python 경로 및 패키지 구조 확인

### **문제 해결 절차**
1. **문제 상황 파악**: 에러 메시지 및 로그 분석
2. **원인 분석**: 문제 발생 지점 및 원인 파악
3. **해결 방안 수립**: 단계별 해결 계획 작성
4. **해결 실행**: 계획에 따른 해결 작업 수행
5. **검증**: 해결 결과 확인 및 테스트
6. **문서화**: 해결 과정 및 방안 기록

## 📚 **참고 자료**

### **기술 문서**
- FastAPI 공식 문서
- SQLAlchemy 공식 문서
- Clean Architecture 원칙
- TDD 방법론

### **프로젝트 문서**
- `task/work-log.md`: 작업 진행 상황
- `task/checklist.md`: 요구사항 체크리스트
- `doc/project-structure.md`: 프로젝트 구조 설명
