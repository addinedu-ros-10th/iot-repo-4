# IoT Care Backend System 개발 지침

## 🚨 **중요: 디렉토리 및 파일 생성 시 주의사항**

### **디렉토리 생성 전 확인 절차**
1. **현재 위치 확인**: `pwd` 명령으로 현재 작업 디렉토리 확인
2. **대상 경로 확인**: `ls -la` 명령으로 대상 디렉토리 존재 여부 확인
3. **중복 방지**: 동일한 이름의 디렉토리/파일이 이미 존재하는지 확인
4. **경로 검증**: 생성할 디렉토리/파일의 경로가 올바른지 검증

### **파일 관리 원칙**
- **절대 경로 사용 금지**: 하드코딩된 절대 경로 사용 금지
- **상대 경로 우선**: 현재 작업 디렉토리 기준 상대 경로 사용
- **경로 검증 의무**: 파일 생성/수정 전 경로 유효성 검증 필수
- **중복 확인**: 동일한 이름의 파일/디렉토리 생성 전 존재 여부 확인

### **Task 폴더 관리 규칙**
- **프로젝트 루트**: `iot-repo-4/task/` - 전체 프로젝트 공통 문서
- **서비스별**: `iot-repo-4/services/was-server/task/` - WAS 서버 전용 문서
- **통합 관리**: 서비스별 문서는 프로젝트 루트로 통합하여 중앙 집중식 관리

---

## 🏗️ **Clean Architecture 구현 지침**

### **1. 레이어 분리 원칙**
- **Domain Layer**: 순수한 비즈니스 로직만 포함
- **Use Case Layer**: 애플리케이션 비즈니스 규칙 구현
- **Interface Layer**: 추상화된 Repository/Service 인터페이스
- **Infrastructure Layer**: 구체적인 구현체 (데이터베이스, 외부 API 등)
- **API Layer**: HTTP 엔드포인트 및 요청/응답 처리

### **2. 의존성 방향**
```
API Layer → Use Case Layer → Domain Layer
     ↓              ↓              ↓
Interface Layer ← Interface Layer ← Interface Layer
     ↓              ↓              ↓
Infrastructure Layer → Infrastructure Layer → Infrastructure Layer
```

**중요**: 의존성은 항상 안쪽(Domain)을 향해야 하며, 바깥쪽(Infrastructure)에서 안쪽으로 의존할 수 없음

### **3. 인터페이스 분리 원칙**
- 각 Repository/Service는 단일 책임을 가져야 함
- 인터페이스는 구체적인 구현에 의존하지 않아야 함
- 의존성 주입을 통해 구체적인 구현체를 주입받아야 함

---

## 📁 **프로젝트 구조 관리**

### **디렉토리 구조**
```
iot-repo-4/
├── task/                           # 전체 프로젝트 공통 문서
│   ├── checklist.md               # 개발 체크리스트
│   ├── work-log.md                # 개발 작업 로그
│   ├── development-guidelines.md  # 개발 지침
│   └── ...
├── services/
│   └── was-server/                # WAS 서버 전용
│       ├── app/                   # 애플리케이션 코드
│       ├── task/                  # WAS 서버 전용 문서 (통합 예정)
│       └── ...
└── ...
```

### **파일 관리 규칙**
- **공통 문서**: 프로젝트 루트 `task/` 폴더에 배치
- **서비스별 문서**: 해당 서비스 디렉토리 내 `task/` 폴더에 배치
- **문서 통합**: 서비스별 문서는 주기적으로 프로젝트 루트로 통합

---

## 🔧 **코딩 표준**

### **1. Python 코딩 스타일**
- **PEP 8 준수**: Python 공식 스타일 가이드 준수
- **타입 힌트 사용**: 모든 함수와 변수에 타입 힌트 명시
- **문서화**: 모든 클래스와 함수에 docstring 작성
- **에러 처리**: 적절한 예외 처리 및 로깅 구현

### **2. FastAPI 사용 규칙**
- **의존성 주입**: `Depends()`를 사용한 의존성 주입 구현
- **Pydantic 모델**: 요청/응답 데이터 검증을 위한 Pydantic 스키마 사용
- **HTTP 상태 코드**: 적절한 HTTP 상태 코드 반환
- **에러 응답**: 일관된 에러 응답 형식 사용

### **3. 데이터베이스 접근**
- **Repository 패턴**: 데이터 접근 로직을 Repository 클래스로 캡슐화
- **트랜잭션 관리**: 적절한 트랜잭션 경계 설정
- **연결 풀링**: 데이터베이스 연결 풀 관리
- **비동기 처리**: SQLAlchemy async 기능 활용

---

## 🧪 **테스트 지침**

### **1. TDD 원칙**
- **테스트 우선**: 기능 구현 전 테스트 코드 작성
- **리팩토링**: 테스트 통과 후 코드 개선
- **커버리지**: 최소 80% 이상의 테스트 커버리지 유지

### **2. 테스트 구조**
- **Unit Test**: 개별 함수/클래스 단위 테스트
- **Integration Test**: 여러 컴포넌트 간 통합 테스트
- **End-to-End Test**: 전체 시스템 동작 테스트

### **3. 테스트 데이터**
- **테스트 DB**: 테스트 전용 데이터베이스 사용
- **Fixture**: 테스트 데이터를 위한 fixture 파일 사용
- **Cleanup**: 테스트 후 데이터 정리

---

## 📚 **문서화 지침**

### **1. 필수 문서**
- **README.md**: 프로젝트 개요 및 시작 가이드
- **API 문서**: Swagger UI를 통한 자동 API 문서 생성
- **개발 가이드**: 개발자 온보딩 및 참고 자료
- **배포 가이드**: 운영 환경 배포 및 관리 방법

### **2. 문서 관리**
- **버전 관리**: 문서 변경 이력 관리
- **검토 프로세스**: 문서 작성 후 검토 및 승인 절차
- **정기 업데이트**: 프로젝트 진행에 따른 문서 정기 업데이트

---

## 🚀 **배포 및 운영**

### **1. 환경별 설정**
- **Local**: 개발자 로컬 환경
- **Development**: 개발 서버 환경
- **Production**: 운영 서버 환경

### **2. 컨테이너 관리**
- **Docker**: 애플리케이션 컨테이너화
- **Docker Compose**: 다중 컨테이너 오케스트레이션
- **볼륨 관리**: 데이터 영속성을 위한 볼륨 마운트

### **3. 모니터링**
- **로깅**: 구조화된 로그 수집 및 관리
- **메트릭**: 성능 및 상태 메트릭 수집
- **알림**: 이상 상황 발생 시 알림 시스템

---

## 📋 **체크리스트**

### **개발 시작 전**
- [ ] 현재 작업 디렉토리 확인 (`pwd`)
- [ ] 대상 경로 존재 여부 확인 (`ls -la`)
- [ ] 개발 지침 문서 검토
- [ ] 기존 코드 구조 파악

### **코드 작성 중**
- [ ] Clean Architecture 원칙 준수
- [ ] 의존성 주입 패턴 적용
- [ ] 적절한 에러 처리 구현
- [ ] 타입 힌트 및 문서화

### **테스트 및 검증**
- [ ] TDD 원칙에 따른 테스트 코드 작성
- [ ] 모든 테스트 케이스 통과 확인
- [ ] 코드 리뷰 및 개선
- [ ] 문서 업데이트

---

**마지막 업데이트**: 2024-12-19  
**작성자**: AI Assistant  
**검토자**: 사용자  
**상태**: 활성 ✅
