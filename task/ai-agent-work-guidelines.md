# AI Agent 작업 수행 지침

## 🎯 **목적**
AI Agent가 모노레포 구조를 준수하고 올바른 경로에서 작업을 수행할 수 있도록 구체적인 지침을 제공합니다.

## 📋 **작업 수행 전 필수 절차**

### **1단계: 경로 확인 및 검증**
```bash
# 반드시 수행해야 할 명령어
pwd  # 현재 작업 디렉토리 확인
ls -la  # 현재 디렉토리 내용 확인
```

**검증 기준:**
- ✅ **WAS 서버 작업**: `services/was-server` 경로에서만 수행
- ✅ **FastAPI 앱 구조**: `services/was-server/app` 하위에서만 작업
- ❌ **프로젝트 루트**: WAS 작업 금지, 전체 프로젝트 관리만 수행

### **2단계: 요청 내용 구체성 검증**
**요청이 다음 항목을 포함하는지 확인:**
- [ ] **작업 대상 경로**: `services/was-server` 또는 `services/was-server/app` 등
- [ ] **구체적인 작업 내용**: "생성", "수정", "삭제" 등
- [ ] **파일/디렉토리명**: 정확한 이름과 확장자
- [ ] **작업 범위**: 어느 레이어/모듈에 작업할지

### **3단계: 작업 수행 및 검증**
```bash
# 작업 수행 후 반드시 검증
ls -la [작업한_경로]  # 작업 결과 확인
pwd  # 여전히 올바른 위치에 있는지 확인
```

## 🚨 **요청 구체성 부족 시 재질문 프로토콜**

### **재질문이 필요한 경우**
1. **경로 불명확**: "app 폴더에" → "어느 경로의 app 폴더인가요?"
2. **작업 내용 불명확**: "구조를 만들어줘" → "어떤 구조를 어떻게 만들어야 하나요?"
3. **범위 불명확**: "설정 파일" → "어느 모듈의 어떤 설정 파일인가요?"

### **재질문 예시**
```
사용자 요청: "app 폴더에 구조를 생성해줘"

AI Agent 재질문:
"구체적인 작업 경로와 내용을 확인하고 싶습니다:

1. 작업 경로: services/was-server/app 폴더가 맞나요?
2. 생성할 구조: 클린 아키텍처 레이어 구조(domain, use_cases 등)가 맞나요?
3. 작업 범위: 전체 레이어 구조를 한 번에 생성하나요?

위 내용이 맞다면 '네, 맞습니다'라고 답변해 주세요.
수정이 필요하다면 구체적으로 어떤 부분을 어떻게 수정해야 하는지 알려주세요."
```

## 📁 **모노레포 구조별 작업 경로**

### **services/was-server/**
- **전체 WAS 서버 관리**: Docker Compose, 환경 설정, 전체 구조
- **작업 예시**: `docker-compose.yml`, `requirements.txt`, `README.md`

### **services/was-server/app/**
- **FastAPI 애플리케이션 코드**: 클린 아키텍처 레이어 구조
- **작업 예시**: `app/domain/`, `app/use_cases/`, `app/main.py`

### **task/**
- **작업 관리 문서**: 체크리스트, 작업 로그, 가이드라인
- **작업 예시**: `task/checklist.md`, `task/work-log.md`

### **doc/**
- **프로젝트 전체 문서**: 모노레포 가이드, 프로젝트 구조
- **작업 예시**: `doc/monorepo-guide.md`, `doc/project-structure.md`

## ⚠️ **금지 사항**

### **절대 하지 말아야 할 것들**
1. **프로젝트 루트에 WAS 관련 파일 생성**: `iot-repo-4/app/` 등
2. **절대 경로 하드코딩**: 전체 경로를 코드에 직접 입력
3. **경로 확인 없이 작업**: `pwd` 명령 없이 파일 생성/수정
4. **모호한 요청 즉시 실행**: 구체성이 부족한 요청을 추측하여 실행
5. **상대 경로 사용**: `app/domain/__init__.py` 등 모호한 상대 경로 사용
6. **터미널 명령어 의존**: 불안정한 터미널 명령어에 의존한 작업

### **잘못된 작업 예시**
```bash
# ❌ 잘못된 예시
mkdir -p /c/Users/.../iot-repo-4/app  # 절대 경로 사용
touch app/config.py  # 경로 확인 없이 실행
edit_file app/domain/__init__.py  # 모호한 상대 경로 사용
```

## 🔄 **작업 수행 플로우**

```
1. 사용자 요청 수신
2. 요청 구체성 검증
   ├─ 구체성 충분 → 3단계 진행
   └─ 구체성 부족 → 재질문 수행
3. 프로젝트 구조 확인 (list_dir 도구 사용)
4. 작업 대상 경로 검증 (절대 경로 사용)
5. 작업 수행
6. 결과 검증 (list_dir 도구 사용)
7. 작업 완료 보고
```

## 🛡️ **향후 문제 방지 방안**

### **1. 절대 경로 사용 원칙**
- **모든 파일 작업 시**: `services/was-server/` 기준 절대 경로 사용
- **상대 경로 금지**: `app/domain/__init__.py` 등 모호한 상대 경로 사용 금지
- **경로 명시**: `services/was-server/app/domain/__init__.py` 형태로 명확하게 지정

### **2. 파일 도구 우선 사용**
- **터미널 명령어 최소화**: 불안정한 `run_terminal_cmd` 의존성 줄이기
- **list_dir 도구 활용**: 디렉토리 구조 확인 시 우선 사용
- **read_file 도구 활용**: 파일 내용 확인 시 우선 사용

### **3. 작업 전 구조 확인 의무화**
- **모든 작업 전**: `list_dir` 도구로 대상 경로 구조 확인
- **작업 후 검증**: 결과 확인을 위한 구조 재검증
- **문서화**: 모든 작업 과정을 task 폴더에 상세 기록

## 📚 **참고 문서**

- **개발 작업 가이드라인**: `task/development-guidelines.md`
- **모노레포 가이드**: `doc/monorepo-guide.md`
- **프로젝트 구조**: `doc/project-structure.md`

---

**작성일**: 2024-08-20  
**작성자**: AI Assistant  
**검토자**: 사용자  
**상태**: 활성화 ✅
